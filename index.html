<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Neon Arcade</title>

<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#050608">

<style>
:root{
  --bg:#050608;
  --neon:#00ffea;
  --danger:#ff0066;
}

*{box-sizing:border-box}

body{
  margin:0;
  background:radial-gradient(circle at top, #0a0f14, #050608 70%);
  color:var(--neon);
  font-family:Orbitron, Arial, sans-serif;
  overflow:hidden;
}

/* ===== CANVAS ===== */
canvas{
  display:block;
}

/* ===== OVERLAYS ===== */
.overlay{
  position:fixed;
  inset:0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  background:rgba(5,6,8,0.88);
  backdrop-filter: blur(6px);
}

.hidden{display:none}

/* ===== BUTTONS ===== */
.btn{
  padding:18px 60px;
  font-size:18px;
  margin:12px;
  background:transparent;
  color:var(--neon);
  border:2px solid var(--neon);
  border-radius:14px;
  cursor:pointer;
  letter-spacing:2px;
  box-shadow:
    0 0 12px var(--neon),
    inset 0 0 12px rgba(0,255,234,0.4);
  transition:0.25s;
}

.btn:hover{
  background:var(--neon);
  color:#050608;
  box-shadow:
    0 0 25px var(--neon),
    0 0 60px rgba(0,255,234,0.6);
  transform:scale(1.05);
}

/* ===== TITLES ===== */
h1{
  font-size:56px;
  margin-bottom:30px;
  text-shadow:
    0 0 10px var(--neon),
    0 0 40px rgba(0,255,234,0.6);
}

/* ===== HUD ===== */
#hud{
  position:fixed;
  top:20px;
  left:20px;
  font-size:18px;
  line-height:1.6;
  text-shadow:0 0 8px var(--neon);
}

/* ===== PAUSE ===== */
#pause h2,
#settings h2{
  margin-bottom:20px;
}

/* ===== BACKGROUND GRID ===== */
#grid{
  position:fixed;
  inset:0;
  background:
    linear-gradient(rgba(0,255,234,0.05) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,255,234,0.05) 1px, transparent 1px);
  background-size:40px 40px;
  pointer-events:none;
}
</style>
</head>
<body>

<div id="grid"></div>

<!-- MENU -->
<div id="menu" class="overlay">
  <h1>NEON ARCADE</h1>
  <button class="btn" onclick="Engine.start('dodge')">DODGE</button>
  <button class="btn" onclick="Engine.start('reaction')">REACTION</button>
  <button class="btn" onclick="Engine.openSettings()">SETTINGS</button>
</div>

<!-- SETTINGS -->
<div id="settings" class="overlay hidden">
  <h2>DIFFICULTY</h2>
  <select id="difficulty">
    <option value="1">EASY</option>
    <option value="1.5">NORMAL</option>
    <option value="2">HARD</option>
  </select>
  <br><br>
  <button class="btn" onclick="Engine.saveSettings()">SAVE</button>
</div>

<!-- PAUSE -->
<div id="pause" class="overlay hidden">
  <h2>PAUSED</h2>
  <button class="btn" onclick="Engine.resume()">RESUME</button>
  <button class="btn" onclick="Engine.quit()">QUIT</button>
</div>

<div id="hud"></div>
<canvas id="game"></canvas>

<script>
/* ================= CORE ================= */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
function resize(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
addEventListener("resize", resize);
resize();

/* ================= INPUT ================= */
const Input = {
  keys:{},
  init(){
    addEventListener("keydown",e=>{
      this.keys[e.key]=true;
      if(e.key==="Escape") Engine.togglePause();
    });
    addEventListener("keyup",e=>this.keys[e.key]=false);
  }
};

/* ================= AUDIO ================= */
const AudioSys = {
  ctx:new (window.AudioContext||window.webkitAudioContext)(),
  beep(freq=500){
    const o=this.ctx.createOscillator();
    const g=this.ctx.createGain();
    o.frequency.value=freq;
    g.gain.value=0.1;
    o.connect(g);
    g.connect(this.ctx.destination);
    o.start();
    setTimeout(()=>o.stop(),80);
  }
};

/* ================= ENGINE ================= */
const Engine = {
  state:"menu",
  game:null,
  score:0,
  difficulty:localStorage.getItem("difficulty")||1,

  start(name){
    this.state="game";
    this.score=0;
    hideAll();
    this.game=Games[name];
    this.game.init();
  },

  update(dt){
    if(this.state==="game") this.game.update(dt);
  },

  draw(){
    if(this.state==="game") this.game.draw();
  },

  togglePause(){
    if(this.state==="game"){
      this.state="pause";
      show("pause");
    }else if(this.state==="pause"){
      this.resume();
    }
  },

  resume(){
    this.state="game";
    hide("pause");
  },

  quit(){
    this.state="menu";
    hideAll();
    show("menu");
  },

  openSettings(){
    hideAll();
    show("settings");
  },

  saveSettings(){
    this.difficulty=document.getElementById("difficulty").value;
    localStorage.setItem("difficulty",this.difficulty);
    hide("settings");
    show("menu");
  }
};

/* ================= GAMES ================= */
const Games = {

  dodge:{
    init(){
      this.p={x:canvas.width/2,y:canvas.height/2,s:28,v:400*Engine.difficulty};
      this.e={x:100,y:100,s:40,vx:260*Engine.difficulty,vy:260*Engine.difficulty};
    },
    update(dt){
      const p=this.p;
      if(Input.keys.w||Input.keys.ArrowUp) p.y-=p.v*dt;
      if(Input.keys.s||Input.keys.ArrowDown) p.y+=p.v*dt;
      if(Input.keys.a||Input.keys.ArrowLeft) p.x-=p.v*dt;
      if(Input.keys.d||Input.keys.ArrowRight) p.x+=p.v*dt;

      const e=this.e;
      e.x+=e.vx*dt; e.y+=e.vy*dt;
      if(e.x<0||e.x+e.s>canvas.width) e.vx*=-1;
      if(e.y<0||e.y+e.s>canvas.height) e.vy*=-1;

      if(
        p.x<e.x+e.s&&p.x+p.s>e.x&&
        p.y<e.y+e.s&&p.y+p.s>e.y
      ){
        AudioSys.beep(200);
        Engine.quit();
      }

      Engine.score+=dt*60;
    },
    draw(){
      ctx.shadowBlur=20;
      ctx.shadowColor="var(--neon)";
      ctx.fillStyle="#00ffea";
      ctx.fillRect(this.p.x,this.p.y,this.p.s,this.p.s);
      ctx.shadowColor="var(--danger)";
      ctx.fillStyle="#ff0066";
      ctx.fillRect(this.e.x,this.e.y,this.e.s,this.e.s);
      hud.innerHTML=`SCORE<br>${Math.floor(Engine.score)}`;
      ctx.shadowBlur=0;
    }
  },

  reaction:{
    init(){this.t=null},
    update(){
      if(!this.t){
        this.t={
          x:Math.random()*(canvas.width-50),
          y:Math.random()*(canvas.height-50)
        };
      }
    },
    draw(){
      ctx.shadowBlur=20;
      ctx.shadowColor="var(--neon)";
      ctx.fillStyle="#00ffea";
      ctx.fillRect(this.t.x,this.t.y,50,50);
      hud.innerHTML="CLICK FAST";
      ctx.shadowBlur=0;
    }
  }
};

/* ================= LOOP ================= */
let last=0;
function loop(t){
  const dt=(t-last)/1000;
  last=t;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  Engine.update(dt);
  Engine.draw();
  requestAnimationFrame(loop);
}

/* ================= UI ================= */
const hud=document.getElementById("hud");
function hideAll(){
  document.querySelectorAll(".overlay").forEach(e=>e.classList.add("hidden"));
}
function show(id){document.getElementById(id).classList.remove("hidden")}
function hide(id){document.getElementById(id).classList.add("hidden")}

Input.init();
requestAnimationFrame(loop);

if("serviceWorker"in navigator){
  navigator.serviceWorker.register("/service-worker.js");
}
</script>
</body>
</html>
