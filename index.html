<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Neon Games Hub</title>

<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#050608">

<style>
:root{
  --bg:#050608;
  --neon:#00ff95;
  --danger:#ff0066;
  --soft:rgba(0,255,150,.25);
  --text:#eafff6;
}

*{box-sizing:border-box}

body{
  margin:0;
  background:radial-gradient(circle at top,#0d151b,#050608 70%);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  color:var(--text);
  overflow:hidden;
}

/* ===== HUB ===== */
#topbar{
  display:flex;
  align-items:center;
  gap:14px;
  padding:16px;
  border-bottom:1px solid var(--soft);
}

#logo{
  width:40px;height:40px;
  border-radius:10px;
  background:linear-gradient(135deg,var(--neon),#00c27a);
  display:grid;place-items:center;
  font-weight:900;color:#022;
}

#content{
  height:calc(100vh - 72px);
  overflow-y:auto;
  padding:16px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
  gap:16px;
}

.card{
  background:#0b141a;
  border:1px solid var(--soft);
  border-radius:16px;
  padding:14px;
  display:flex;
  flex-direction:column;
  gap:12px;
}

.card h3{margin:0;color:var(--neon)}
.play{
  margin-top:auto;
  padding:12px;
  border-radius:14px;
  border:1px solid var(--soft);
  background:#050608;
  color:var(--text);
  cursor:pointer;
}

/* ===== GAME OVERLAY ===== */
#overlay{
  position:fixed;
  inset:0;
  background:#050608;
  display:none;
  z-index:1000;
}

canvas{display:block}

/* ===== TOUCH CONTROLS ===== */
#controls{
  position:fixed;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  display:none;
  gap:10px;
}

.ctrl{
  width:60px;height:60px;
  border-radius:50%;
  background:rgba(0,255,150,.15);
  border:1px solid var(--soft);
  display:grid;place-items:center;
  font-size:22px;
}
</style>
</head>
<body>

<div id="topbar">
  <div id="logo">N</div>
  <strong>Neon Games Hub</strong>
</div>

<div id="content">
  <div class="grid" id="grid"></div>
</div>

<div id="overlay">
  <canvas id="game"></canvas>
  <div id="controls">
    <div class="ctrl" data-k="ArrowLeft">◀</div>
    <div class="ctrl" data-k="ArrowRight">▶</div>
    <div class="ctrl" data-k="ArrowUp">▲</div>
    <div class="ctrl" data-k="ArrowDown">▼</div>
  </div>
</div>

<script>
/* ================= HUB ================= */
const games=[
  {id:"snake",name:"Snake"},
  {id:"tetris",name:"Tetris"},
  {id:"platformer",name:"Platformer"},
  {id:"tower",name:"Tower Defense"}
];

const grid=document.getElementById("grid");
const overlay=document.getElementById("overlay");
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
const controls=document.getElementById("controls");
const keys={};

games.forEach(g=>{
  const c=document.createElement("div");
  c.className="card";
  c.innerHTML=`<h3>${g.name}</h3><button class="play">Play</button>`;
  c.querySelector(".play").onclick=()=>startGame(g.id);
  grid.appendChild(c);
});

function resize(){
  canvas.width=innerWidth;
  canvas.height=innerHeight;
}
window.addEventListener("resize",resize);

/* ================= INPUT ================= */
window.addEventListener("keydown",e=>{
  keys[e.key]=true;
  if(e.key==="Escape") exitGame();
});
window.addEventListener("keyup",e=>keys[e.key]=false);

document.querySelectorAll(".ctrl").forEach(b=>{
  b.ontouchstart=()=>keys[b.dataset.k]=true;
  b.ontouchend=()=>keys[b.dataset.k]=false;
});

/* ================= ENGINE ================= */
let game=null;

function startGame(id){
  resize();
  overlay.style.display="block";
  controls.style.display="flex";
  game=Games[id];
  game.init();
  loop();
}

function exitGame(){
  overlay.style.display="none";
  controls.style.display="none";
  game=null;
}

function loop(){
  if(!game) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  game.update();
  game.draw();
  requestAnimationFrame(loop);
}

/* ================= GAMES ================= */
const Games={

  snake:{
    init(){
      this.s=20;
      this.sn=[{x:10,y:10}];
      this.d={x:1,y:0};
      this.f={x:15,y:15};
      this.t=0;
    },
    update(){
      if(++this.t<6) return;
      this.t=0;
      if(keys.ArrowUp) this.d={x:0,y:-1};
      if(keys.ArrowDown) this.d={x:0,y:1};
      if(keys.ArrowLeft) this.d={x:-1,y:0};
      if(keys.ArrowRight) this.d={x:1,y:0};
      const h={x:this.sn[0].x+this.d.x,y:this.sn[0].y+this.d.y};
      if(h.x<0||h.y<0||h.x>canvas.width/this.s||h.y>canvas.height/this.s) return exitGame();
      this.sn.unshift(h);
      if(h.x===this.f.x&&h.y===this.f.y){
        this.f={x:Math.random()*20|0,y:Math.random()*20|0};
      } else this.sn.pop();
    },
    draw(){
      ctx.fillStyle=varNeon;
      this.sn.forEach(s=>ctx.fillRect(s.x*this.s,s.y*this.s,this.s-2,this.s-2));
      ctx.fillStyle=varDanger;
      ctx.fillRect(this.f.x*this.s,this.f.y*this.s,this.s-2,this.s-2);
    }
  },

  tetris:{
    init(){
      this.y=0;
    },
    update(){
      this.y+=2;
      if(this.y>canvas.height) exitGame();
    },
    draw(){
      ctx.fillStyle=varNeon;
      ctx.fillRect(canvas.width/2-20,this.y,40,40);
    }
  },

platformer:{
  init(){
    // world
    this.scroll = 0;
    this.speed = 3;
    this.gravity = 0.7;
    this.jumpPower = -14;
    this.score = 0;

    // player
    this.player = {
      x: 120,
      y: 200,
      w: 28,
      h: 28,
      vy: 0,
      onGround: false,
      jumpBuffer: 0
    };

    // platforms
    this.platforms = [];
    let x = 0;
    for(let i=0;i<12;i++){
      this.platforms.push({
        x: x,
        y: 320 + Math.random()*40,
        w: 120 + Math.random()*80
      });
      x += 160 + Math.random()*80;
    }

    // spikes
    this.spikes = [];
  },

  update(){
    const p = this.player;

    // increase difficulty
    this.speed += 0.0008;
    this.scroll += this.speed;
    this.score += this.speed * 0.1;

    // input
    if(keys.ArrowUp) p.jumpBuffer = 6;

    // physics
    p.vy += this.gravity;
    p.y += p.vy;

    // collision reset
    p.onGround = false;

    // platform collision
    this.platforms.forEach(pl=>{
      const px = pl.x - this.scroll;
      if(
        p.x < px + pl.w &&
        p.x + p.w > px &&
        p.y + p.h > pl.y &&
        p.y + p.h < pl.y + 20 &&
        p.vy >= 0
      ){
        p.y = pl.y - p.h;
        p.vy = 0;
        p.onGround = true;
      }
    });

    // jump buffer
    if(p.jumpBuffer > 0){
      if(p.onGround){
        p.vy = this.jumpPower;
        p.onGround = false;
        p.jumpBuffer = 0;
      }
      p.jumpBuffer--;
    }

    // generate new platforms
    const last = this.platforms[this.platforms.length-1];
    if(last.x - this.scroll < canvas.width){
      this.platforms.push({
        x: last.x + 160 + Math.random()*120,
        y: 260 + Math.random()*80,
        w: 100 + Math.random()*100
      });

      // spikes
      if(Math.random() < 0.4){
        this.spikes.push({
          x: last.x + 80,
          y: 340,
          w: 40,
          h: 20
        });
      }
    }

    // remove old platforms
    if(this.platforms[0].x - this.scroll + this.platforms[0].w < 0){
      this.platforms.shift();
    }

    // spike collision
    this.spikes.forEach(s=>{
      const sx = s.x - this.scroll;
      if(
        p.x < sx + s.w &&
        p.x + p.w > sx &&
        p.y < s.y + s.h &&
        p.y + p.h > s.y
      ){
        this.init();
      }
    });

    // remove old spikes
    if(this.spikes.length && this.spikes[0].x - this.scroll < -50){
      this.spikes.shift();
    }

    // fall = death
    if(p.y > canvas.height){
      this.init();
    }
  },

  draw(){
    // background gradient
    const g = ctx.createLinearGradient(0,0,0,canvas.height);
    g.addColorStop(0,"#0d151b");
    g.addColorStop(1,"#050608");
    ctx.fillStyle = g;
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // platforms
    ctx.fillStyle = "#2a2a2a";
    this.platforms.forEach(pl=>{
      ctx.fillRect(
        pl.x - this.scroll,
        pl.y,
        pl.w,
        16
      );
    });

    // spikes
    ctx.fillStyle = "#ff0066";
    this.spikes.forEach(s=>{
      const x = s.x - this.scroll;
      ctx.beginPath();
      ctx.moveTo(x, s.y + s.h);
      ctx.lineTo(x + s.w/2, s.y);
      ctx.lineTo(x + s.w, s.y + s.h);
      ctx.fill();
    });

    // player glow
    ctx.shadowBlur = 20;
    ctx.shadowColor = "#00ff95";
    ctx.fillStyle = "#00ff95";
    ctx.fillRect(
      this.player.x,
      this.player.y,
      this.player.w,
      this.player.h
    );
    ctx.shadowBlur = 0;

    // HUD
    ctx.fillStyle = "#00ff95";
    ctx.font = "18px system-ui";
    ctx.fillText(
      "DISTANCE: " + Math.floor(this.score),
      20,
      30
    );
  }
},

  tower:{
    init(){
      this.e=0;
    },
    update(){ this.e+=1; if(this.e>canvas.width) exitGame(); },
    draw(){
      ctx.fillStyle=varDanger;
      ctx.fillRect(this.e,canvas.height/2,20,20);
      ctx.fillStyle=varNeon;
      ctx.fillRect(100,canvas.height/2,30,30);
    }
  }

};

const varNeon="#00ff95";
const varDanger="#ff0066";
</script>

<script>
if("serviceWorker"in navigator){
  navigator.serviceWorker.register("/service-worker.js");
}
</script>

</body>
</html>
