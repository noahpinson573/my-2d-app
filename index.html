<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Neon Arcade</title>

<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#050608">

<style>
body{
  margin:0;
  background:#050608;
  color:#00ffea;
  font-family: Arial, sans-serif;
  overflow:hidden;
}

canvas{display:block;}

#menu{
  position:fixed;
  inset:0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:25px;
  animation: fadeIn 0.8s;
}

@keyframes fadeIn{
  from{opacity:0; transform:scale(0.95);}
  to{opacity:1; transform:scale(1);}
}

h1{
  font-size:48px;
  text-shadow:0 0 20px #00ffea;
}

.menu-btn{
  padding:18px 60px;
  font-size:20px;
  background:#050608;
  color:#00ffea;
  border:2px solid #00ffea;
  border-radius:12px;
  cursor:pointer;
  box-shadow:0 0 15px #00ffea;
  transition:0.2s;
}

.menu-btn:hover{
  background:#00ffea;
  color:#050608;
}

#backBtn{
  position:fixed;
  top:20px;
  left:20px;
  padding:12px 20px;
  background:#050608;
  color:#00ffea;
  border:2px solid #00ffea;
  border-radius:8px;
  cursor:pointer;
  display:none;
}

#hud{
  position:fixed;
  top:20px;
  right:20px;
  text-align:right;
  display:none;
}
</style>
</head>
<body>

<div id="menu">
  <h1>NEON ARCADE</h1>
  <button class="menu-btn" onclick="startGame('dodge')">Dodge Square</button>
  <button class="menu-btn" onclick="startGame('reaction')">Reaction Test</button>
</div>

<button id="backBtn" onclick="goMenu()">â¬… Menu</button>

<div id="hud">
  <div id="score"></div>
  <div id="highScore"></div>
  <div id="time"></div>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const menu = document.getElementById("menu");
const backBtn = document.getElementById("backBtn");
const hud = document.getElementById("hud");
const scoreEl = document.getElementById("score");
const highScoreEl = document.getElementById("highScore");
const timeEl = document.getElementById("time");

function resize(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
addEventListener("resize", resize);
resize();

let screen = "menu";
let keys = {};
addEventListener("keydown", e => keys[e.key] = true);
addEventListener("keyup", e => keys[e.key] = false);

function startGame(name){
  screen = name;
  menu.style.display = "none";
  backBtn.style.display = "block";
  hud.style.display = "block";
  resetGame();
}

function goMenu(){
  screen = "menu";
  menu.style.display = "flex";
  backBtn.style.display = "none";
  hud.style.display = "none";
}

let score = 0;
let time = 0;
let highScore = localStorage.getItem("highScore") || 0;

/* ---------- GAME 1: DODGE ---------- */
let player, enemy;

function resetGame(){
  score = 0;
  time = 0;
  player = { x:canvas.width/2, y:canvas.height/2, size:30, speed:6 };
  enemy = { x:100, y:100, size:40, vx:4, vy:4 };
}

function dodgeGame(){
  // movement
  if(keys["ArrowUp"] || keys["w"]) player.y -= player.speed;
  if(keys["ArrowDown"] || keys["s"]) player.y += player.speed;
  if(keys["ArrowLeft"] || keys["a"]) player.x -= player.speed;
  if(keys["ArrowRight"] || keys["d"]) player.x += player.speed;

  enemy.x += enemy.vx;
  enemy.y += enemy.vy;

  if(enemy.x < 0 || enemy.x + enemy.size > canvas.width) enemy.vx *= -1;
  if(enemy.y < 0 || enemy.y + enemy.size > canvas.height) enemy.vy *= -1;

  // collision
  if(
    player.x < enemy.x + enemy.size &&
    player.x + player.size > enemy.x &&
    player.y < enemy.y + enemy.size &&
    player.y + player.size > enemy.y
  ){
    highScore = Math.max(score, highScore);
    localStorage.setItem("highScore", highScore);
    resetGame();
  }

  score++;
  time++;

  ctx.fillStyle="#00ffea";
  ctx.fillRect(player.x, player.y, player.size, player.size);

  ctx.fillStyle="#ff0066";
  ctx.fillRect(enemy.x, enemy.y, enemy.size, enemy.size);
}

/* ---------- GAME 2: REACTION ---------- */
let target = null;

canvas.addEventListener("click", () => {
  if(screen === "reaction" && target){
    score += 100;
    target = null;
  }
});

function reactionGame(){
  if(!target){
    target = {
      x: Math.random()*(canvas.width-50),
      y: Math.random()*(canvas.height-50)
    };
  }

  ctx.fillStyle="#00ffea";
  ctx.fillRect(target.x, target.y, 50, 50);

  time++;
}

/* ---------- MAIN LOOP ---------- */
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(screen === "dodge") dodgeGame();
  else if(screen === "reaction") reactionGame();

  scoreEl.textContent = "Score: " + score;
  highScoreEl.textContent = "High: " + highScore;
  timeEl.textContent = "Time: " + Math.floor(time/60);

  requestAnimationFrame(loop);
}
loop();

if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("/service-worker.js");
}
</script>

</body>
</html>
